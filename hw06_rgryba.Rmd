---
title: "Stat547 Homework 6"
author: "Rowenna Gryba"
date: "2018-11-05"
output: github_document
---
  
```{r}
suppressPackageStartupMessages(library(tidyverse))
library(repurrrsive)
library(gapminder)
```

##Question 2 - Write a function for gapminder data
This function runs a linear model to explore the relationship between two variables using a grouping variable. The output is a dataframe with the variable and associated lm output, selecting those models that had significant p-values.
The example below applies the function to the gapminder data and compares population to year for each country.

```{r echo=TRUE}
str(gapminder)

lm_function <- function(df, y, x, group_var) {
  group_var <-  enquo(group_var)
  df %>%
    group_by_(group_var) %>%
    nest() %>%
    mutate(fit = map(data, ~ lm(.[[y]] ~ .[[x]], data=.))) %>%
    mutate(output = map(fit, broom::tidy)) %>%
    unnest(output) %>%
    filter(any(p.value < 0.05)) %>%
    mutate(term = replace(term, term == ".[[x]]", "year"))
}

lm_function(df=gapminder,y="pop", x="year", group_var=country)
```

##Question 5a - Working through the purrr tutorial on a list of GitHub users
```{r}
library(repurrrsive)
library(listviewer)
library(jsonlite)
library(dplyr)
library(tibble)
library(purrr)
```

Explore the data
```{r}
str(gh_users)
str(gh_users, max.level = 2) #shows only the first two levels
str(gh_users, list.len = 2) #shows only the first two elements in each level
```